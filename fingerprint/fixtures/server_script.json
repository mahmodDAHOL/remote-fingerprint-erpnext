[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-07-20 12:24:07.957326",
  "module": "fingerprint",
  "name": "email-req-ceo",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "request-ceo",
  "script": "\n\n# Get the email field from the document\nrecipient = doc.get(\"email\")  # Change \"email\" to your actual email field name\n# id = doc.get(\"id\")  # Change \"email\" to your actual email field name\nid = doc.name  # Change \"email\" to your actual email field name\n\nif not recipient:\n    frappe.throw(\"No email address found for the user.\")\n\nsubject = \"Thank You for Submitting the Form\"\nmessage = f\"\"\"\n<p>مرحباً بكم، </p>\n<p> شكراً لتواصلكم مع وزارة الإعلام. لقد استلمنا طلبكم بنجاح. رقم المراجع الخاص بكم هو: ({id}).\nسيُراجع الفريق المتخصص طلبكم ويرد عليكم بأسرع وقت.\n</p>\n<p>\nأطيب الأمنيات، \nفريق التواصل بوزارة الإعلام\n</p>\n\n\"\"\"\n\ntry:\n    frappe.sendmail(\n        recipients=recipient,\n        subject=subject,\n        message=message,\n queue_separately=False\n    )\n\nexcept Exception as e:\n\n    frappe.throw(f\"Failed to send confirmation email {e}\")\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-11-30 09:56:28.092862",
  "module": "fingerprint",
  "name": "calculate early exit and late entry",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Attendance",
  "script": "# Helper: parse date + time into Python datetime object\ndef parse_datetime(date_str, time_str):\n    return frappe.utils.get_datetime(f\"{date_str} {time_str}\")\n\nif doc.shift:\n    shift = frappe.get_doc(\"Shift Type\", doc.shift)\n    frappe.msgprint(f\"shift.start_time {shift.start_time}\")\n    frappe.msgprint(f\"shift.end_time {shift.end_time}\")\n\n    if shift.start_time and shift.end_time:\n        work_start = parse_datetime(doc.attendance_date, shift.start_time)\n        work_end = parse_datetime(doc.attendance_date, shift.end_time)\n\n        # Calculate late entry\n        if doc.in_time:\n            in_time = frappe.utils.get_datetime(doc.in_time)\n            late_minutes = max((in_time - work_start).total_seconds() / 60, 0)\n            doc.custom_late_entry_in_minutes = round(late_minutes, 1)\n\n        # Calculate early exit\n        if doc.out_time:\n            out_time = frappe.utils.get_datetime(doc.out_time)\n            early_minutes = max((work_end - out_time).total_seconds() / 60, 0)\n            doc.custom_early_exit_in_minutes = round(early_minutes, 1)\n    else:\n        frappe.msgprint(\"Shift Type is missing start or end time.\")\nelse:\n    frappe.msgprint(\"Please select a Shift first.\")\n",
  "script_type": "DocType Event"
 }
]